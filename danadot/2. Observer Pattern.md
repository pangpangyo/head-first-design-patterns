# ì˜µì €ë²„ íŒ¨í„´

## ê¸°ìƒ ìŠ¤í…Œì´ì…˜ìš© ì½”ë“œ ì¶”ê°€í•˜ê¸°

```kotlin
class WeatherData {
    fun getTemperature(): Float
    fun getHumidity(): Float
    fun getPressure(): Float

    /**
     * ê¸°ìƒ ê´€ì¸¡ ê°’ì´ ê°±ì‹ ë  ë•Œë§ˆë‹¤ í˜¸ì¶œ
     */
    fun measurementsChanged() {
        val temperature = getTemperature()
        val humidity = getHumidity()
        val pressure = getPressure()

        // ë””ìŠ¤í”Œë ˆì´ ê°±ì‹ 
        currentConditionsDisplay.update(temperature, humidity, pressure)
        statisticsDisplay.update(temperature, humidity, pressure)
        forecastDisplay.update(temperature, humidity, pressure)
    }
}
```

## ì˜µì €ë²„ íŒ¨í„´

> ğŸ’¡ ì˜µì €ë²„ íŒ¨í„´
>
> í•œ ê°ì²´ì˜ ìƒíƒœê°€ ë°”ë€Œë©´ ê·¸ ê°ì²´ì— ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ ê°ì²´ì—ê²Œ ì—°ë½ì´ ê°€ê³ , ìë™ìœ¼ë¡œ ë‚´ìš©ì´ ê°±ì‹ ë˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì¼ëŒ€ë‹¤ ì˜ì¡´ì„±ì„ ì •ì˜

* ì‹ ë¬¸ì‚¬ + êµ¬ë…ì = ì˜µì €ë²„ íŒ¨í„´
    * í•œ ê°ì²´ì˜ ìƒíƒœê°€ ë³€ê²½ë˜ë©´ ê·¸ ê°ì²´ì— ì˜ì¡´í•˜ëŠ” ëª¨ë“  ê°ì²´ì—ê²Œ ì—°ë½
* ëŠìŠ¨í•œ ê²°í•©
    * ì£¼ì œëŠ” ì˜µì €ë²„ê°€ íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤ëŠ” ì‚¬ì‹¤ë§Œ ì•Œì•„ìš”.
    * ì˜µì €ë²„ëŠ” ì–¸ì œë“ ì§€ ìƒˆë¡œ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”.
    * ìƒˆë¡œìš´ í˜•ì‹ì˜ ì˜µì €ë²„ë¥¼ ì¶”ê°€í•  ë•Œì—ë„ ì£¼ì œë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì „í˜€ ì—†ì–´ìš”.
    * ì£¼ì œì™€ ì˜µì €ë²„ëŠ” ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.
    * ì£¼ì œë‚˜ ì˜µì €ë²„ê°€ ë‹¬ë¼ì ¸ë„ ì„œë¡œì—ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì•„ìš”.

ğŸˆâ€â¬› ìƒí˜¸ì‘ìš©í•˜ëŠ” ê°ì²´ ì‚¬ì´ì—ëŠ” ê°€ëŠ¥í•˜ë©´ ëŠìŠ¨í•œ ê²°í•©ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.

## êµ¬í˜„í•˜ê¸°

```kotlin
fun main() {
    val weatherData = WeatherData()
    val currentDisplay = CurrentConditionDisplay(weatherData)

    weatherData.changeMeasurements(80f, 65f, 30.4f)
}

interface Subject {
    fun registerObserver(observer: Observer)
    fun removeObserver(observer: Observer)
    fun notifyObservers()
}

class WeatherData(
    private var observers: ArrayList<Observer> = arrayListOf()
) : Subject {

    private var temperature: Float = Float.MIN_VALUE
    private var humidity: Float = Float.MIN_VALUE
    private var pressure: Float = Float.MIN_VALUE

    /**
     * subject interface êµ¬í˜„
     */
    override fun registerObserver(observer: Observer) {
        observers.add(observer)
    }

    override fun removeObserver(observer: Observer) {
        observers.remove(observer)
    }

    override fun notifyObservers() {
        observers.forEach {
            it.update(temperature = temperature, humidity = humidity, pressure = pressure)
        }
    }

    fun measurementsChanged() {
        notifyObservers()
    }

    fun changeMeasurements(temperature: Float, humidity: Float, pressure: Float) {
        this.temperature = temperature
        this.humidity = humidity
        this.pressure = pressure
        measurementsChanged()
    }
}

interface Observer {
    fun update(temperature: Float, humidity: Float, pressure: Float)
}

interface DisplayElement {
    fun display()
}

class CurrentConditionDisplay(weatherData: WeatherData) : Observer, DisplayElement {

    init {
        weatherData.registerObserver(this)
    }

    private var temperature = Float.MIN_VALUE
    private var humidity = Float.MIN_VALUE

    override fun display() {
        println("í˜„ì¬ ìƒíƒœ: ì˜¨ë„ $temperature F, ìŠµë„ $humidity %")
    }

    override fun update(temperature: Float, humidity: Float, pressure: Float) {
        this.temperature = temperature
        this.humidity = humidity
        display()
    }
}

class StatisticsDisplay : Observer, DisplayElement {
    override fun display() {
        TODO("Not yet implemented")
    }

    override fun update(temperature: Float, humadity: Float, pressure: Float) {
        TODO("Not yet implemented")
    }
}

class ForecastDisplayDisplay : Observer, DisplayElement {
    override fun display() {
        TODO("Not yet implemented")
    }

    override fun update(temperature: Float, humadity: Float, pressure: Float) {
        TODO("Not yet implemented")
    }
}
```

## Pull ë°©ì‹

* ì£¼ì œê°€ ì˜µì €ë²„ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ” Push
* ì˜µì €ë²„ê°€ ì£¼ì œë¡œë¶€í„° ë°ì´í„°ë¥¼ ë‹¹ê²¨ì˜¤ëŠ” Pull

```kotlin
fun main() {
    val weatherData = WeatherData()
    CurrentConditionDisplay(weatherData)
    ForecastDisplay(weatherData)

    weatherData.changeMeasurements(80f, 65f, 30.4f)
}

interface Subject {
    fun registerObserver(observer: Observer)
    fun removeObserver(observer: Observer)
    fun notifyObservers()
}

class WeatherData(
    private var observers: ArrayList<Observer> = arrayListOf()
) : Subject {

    var temperature: Float = Float.MIN_VALUE
        private set

    var humidity: Float = Float.MIN_VALUE
        private set

    var pressure: Float = Float.MIN_VALUE
        private set

    /**
     * subject interface êµ¬í˜„
     */
    override fun registerObserver(observer: Observer) {
        observers.add(observer)
    }

    override fun removeObserver(observer: Observer) {
        observers.remove(observer)
    }

    override fun notifyObservers() {
        observers.forEach { it.update() }
    }

    fun changeMeasurements(temperature: Float, humidity: Float, pressure: Float) {
        this.temperature = temperature
        this.humidity = humidity
        this.pressure = pressure
        measurementsChanged()
    }

    private fun measurementsChanged() {
        notifyObservers()
    }
}

interface Observer {
    fun update()
}

interface DisplayElement {
    fun display()
}

class CurrentConditionDisplay(
    private val weatherData: WeatherData,
) : Observer, DisplayElement {

    init {
        weatherData.registerObserver(this)
    }

    private var temperature = Float.MIN_VALUE
    private var humidity = Float.MIN_VALUE

    override fun display() {
        println("í˜„ì¬ ìƒíƒœ: ì˜¨ë„ ${temperature}F, ìŠµë„ ${humidity}%")
    }

    override fun update() {
        // weatherDataë¡œë¶€í„° ë°ì´í„° ë‹¹ê²¨ì˜¤ê¸°
        this.temperature = weatherData.temperature
        this.humidity = weatherData.humidity
        display()
    }
}

class ForecastDisplay(
    private val weatherData: WeatherData
) : Observer, DisplayElement {
    init {
        weatherData.registerObserver(this)
    }

    private var currentPressure = 29.92f
    private var lastPressure = Float.MIN_VALUE

    override fun display() {
        if (currentPressure > lastPressure) {
            println("ê¸°ìƒ ì˜ˆë³´: ë‚ ì”¨ê°€ ìŠµí•´ì§€ê³  ìˆìŠµë‹ˆë‹¤.")
        } else if (lastPressure > currentPressure) {
            println("ê¸°ìƒ ì˜ˆë³´: ë‚ ì”¨ê°€ ì¢‹ì•„ì§€ê³  ìˆìŠµë‹ˆë‹¤.")
        } else {
            println("ê¸°ìƒ ì˜ˆë³´: ë˜ì´ë˜ì´ í•©ë‹ˆë‹¤.")
        }
    }

    override fun update() {
        this.lastPressure = currentPressure
        // weatherDataë¡œë¶€í„° ë°ì´í„° ë‹¹ê²¨ì˜¤ê¸°
        this.currentPressure = weatherData.pressure
        display()
    }
}
```